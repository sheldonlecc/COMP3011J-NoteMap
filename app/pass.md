# MapNotes Android Project - å‰ç«¯äº¤æ¥æ–‡æ¡£ (Frontend Handover)

**æäº¤äºº:** Member A (Frontend Development)  
**æ—¥æœŸ:** 2025-11-17  
**ç‰ˆæœ¬:** Alpha v1.0 (UI & Logic Framework)

---

## 1. é¡¹ç›®æ¦‚å†µä¸å®Œæˆåº¦
æœ¬é¡¹ç›® **MapNotes** çš„å‰ç«¯ UI æ¡†æ¶ä¸æ ¸å¿ƒäº¤äº’é€»è¾‘å·²æ­å»ºå®Œæˆã€‚ç›®å‰åº”ç”¨å¤„äº **"UI Ready, Mock Data Driven"**ï¼ˆUI å°±ç»ªï¼Œæœ¬åœ°æ¨¡æ‹Ÿæ•°æ®é©±åŠ¨ï¼‰çŠ¶æ€ã€‚
æ‰€æœ‰æ ¸å¿ƒé¡µé¢ï¼ˆåœ°å›¾ã€è¯¦æƒ…ã€å‘å¸ƒã€ä¸ªäººä¸­å¿ƒã€ç™»å½•æ³¨å†Œï¼‰å‡å·²å®ç°å¸ƒå±€ä¸è·³è½¬é€»è¾‘ï¼Œåœ°å›¾éƒ¨åˆ†å·²é›†æˆé«˜å¾· SDK å¹¶å®ç°äº†å¤æ‚çš„èšåˆï¼ˆClusteringï¼‰ä¸è‡ªå®šä¹‰æ ‡è®°åŠŸèƒ½ã€‚

### âœ… å·²å®Œæˆæ¨¡å— (Delivered Modules)

| æ¨¡å— | çŠ¶æ€ | æè¿° | å…³é”®æ–‡ä»¶ (Java / XML) |
| :--- | :--- | :--- | :--- |
| **åœ°å›¾ä¸»é¡µ** | âœ… å®Œæˆ | é›†æˆé«˜å¾·åœ°å›¾ï¼Œå®ç°å®šä½ã€POI æœç´¢ã€**ç…§ç‰‡æ ‡è®° (Photo Marker)**ã€**ç‚¹èšåˆ (Clustering)**ã€‚ | `MainActivity`<br>`activity_main.xml` |
| **ç¬”è®°å‘å¸ƒ** | âœ… å®Œæˆ | åŒ…å«å›¾ç‰‡é€‰æ‹©(UI)ã€ä½ç½®è‡ªåŠ¨åå‘åœ°ç†ç¼–ç (æ˜¾ç¤ºè¡—é“å)ã€ç±»å‹é€‰æ‹©ã€‚ | `AddNoteActivity`<br>`activity_add_note.xml` |
| **ç¬”è®°è¯¦æƒ…** | âœ… å®Œæˆ | å±•ç¤ºç¬”è®°å¤§å›¾ã€æ ‡é¢˜ã€æè¿°ã€ä½ç½®ã€ç±»å‹ã€‚æ”¯æŒä»åœ°å›¾ Marker è·³è½¬ã€‚ | `NoteDetailActivity`<br>`activity_note_detail.xml` |
| **èšåˆåˆ—è¡¨** | âœ… å®Œæˆ | ç‚¹å‡»èšåˆç‚¹åæ˜¾ç¤ºçš„ç€‘å¸ƒæµåˆ—è¡¨ï¼Œå±•ç¤ºè¯¥åŒºåŸŸæ‰€æœ‰ç¬”è®°ã€‚ | `ClusterDetailActivity`<br>`activity_cluster_detail.xml` |
| **ä¸ªäººä¸­å¿ƒ** | âœ… å®Œæˆ | åŒ…å«ç”¨æˆ·ä¿¡æ¯å¤´ã€"ä½œå“/ç‚¹èµ" Tab åˆ‡æ¢é€»è¾‘ã€‚ | `ProfileActivity`<br>`activity_profile.xml` |
| **è®¤è¯é¡µé¢** | âœ… å®Œæˆ | ç™»å½•ä¸æ³¨å†Œé¡µé¢çš„å®Œæ•´ UI å¸ƒå±€ä¸ç©ºå£³é€»è¾‘ã€‚ | `LoginActivity`, `RegisterActivity`<br>`activity_login.xml` |

---

## 2. æ ¸å¿ƒæŠ€æœ¯å®ç°è¯´æ˜ (Key Technical Details)

### A. åœ°å›¾èšåˆä¸è‡ªå®šä¹‰ Marker (æ ¸å¿ƒäº®ç‚¹)
ä¸ºäº†å®ç°è§„åˆ’ä¹¦ä¸­ *"Map-first content discovery"* çš„ç›®æ ‡ï¼Œåœ°å›¾å±‚é‡‡ç”¨äº†è‡ªå®šä¹‰æ¸²æŸ“ï¼š
* **è‡ªå®šä¹‰ Marker**: æ²¡æœ‰ä½¿ç”¨é»˜è®¤å¤§å¤´é’ˆã€‚åœ¨ `MainActivity` ä¸­é¢„ç•™äº† `getCustomMarkerIcon()` æ–¹æ³•ï¼Œé€šè¿‡ `layout_marker_photo.xml` å°†å›¾ç‰‡åŠ¨æ€è½¬æ¢ä¸º Marker å›¾æ ‡ã€‚
* **èšåˆ (Clustering)**: å¼•å…¥äº† `ClusterOverlay`, `Cluster`, `ClusterRender` ç­‰è¾…åŠ©ç±»ã€‚å½“å¤§é‡ç¬”è®°èšé›†æ—¶ï¼Œä¼šè‡ªåŠ¨åˆå¹¶ä¸ºä¸€ä¸ªå¸¦æœ‰æ•°å­—çš„åœ†åœˆï¼Œç‚¹å‡»åè·³è½¬è‡³ `ClusterDetailActivity` æŸ¥çœ‹åˆ—è¡¨ã€‚

### B. æ•°æ®ä¼ é€’æ¨¡å‹
é¡µé¢é—´é€šè¿‡ Intent ä¼ é€’æ•°æ®ï¼Œæ ¸å¿ƒæ¨¡å‹ä¸º `RegionItem` (éœ€ç¡®ä¿åç«¯å¯¹æ¥æ—¶ä¿æŒä¸€è‡´æˆ–è¿›è¡Œé€‚é…)ï¼š
* **ä¼ é€’ Key**: `NoteDetailActivity.EXTRA_NOTE_DATA`
* **æ•°æ®æµ**: `MainActivity` (Mock Data) -> `Intent` -> `NoteDetailActivity` / `ClusterDetailActivity`ã€‚

### C. ç¬¬ä¸‰æ–¹åº“ä¾èµ–
* **é«˜å¾·åœ°å›¾ SDK**: ç”¨äºåœ°å›¾æ˜¾ç¤ºã€å®šä½ã€é€†åœ°ç†ç¼–ç  (Regeocode)ã€‚
* **Glide**: ç”¨äºåŠ è½½ç¬”è®°å›¾ç‰‡å’Œç”¨æˆ·å¤´åƒã€‚
* **Material Design**: ä½¿ç”¨äº† `TabLayout`, `FloatingActionButton`, `CardView` ç­‰ç»„ä»¶ã€‚

---

## 3. åç«¯å¼€å‘å¯¹æ¥æŒ‡å— (For Member B)

Member Bï¼Œä½ çš„ä¸»è¦ä»»åŠ¡æ˜¯å°†ç›®å‰çš„â€œæœ¬åœ°å‡æ•°æ®â€æ›¿æ¢ä¸º **Firebase** çš„çœŸå®æ•°æ®ã€‚

### ğŸ“‹ å¾…åŠäº‹é¡¹æ¸…å•
1.  **æ•°æ®åº“è®¾è®¡ (Firestore)**
    * **User Collection**: `uid`, `username`, `email`, `avatarUrl`...
    * **Notes Collection**:
        * `title` (String)
        * `description` (String)
        * `type` (String: "ç¾é£Ÿ", "é£æ™¯"...)
        * `geo_point` (GeoPoint: lat, lng) - **å…³é”®**ï¼šç”¨äºåœ°å›¾æ ‡è®°
        * `location_name` (String: "åŒ—äº¬å¸‚æœé˜³åŒº...")
        * `image_url` (String æˆ– List<String>) - *å»ºè®®è®¾è®¡ä¸º Array ä»¥æ”¯æŒæœªæ¥çš„å¤šå›¾åŠŸèƒ½*ã€‚
        * `author_id` (Reference)
        * `timestamp`

### 2. æ¥å…¥çœŸå®æ•°æ®æº (Data Integration)

* **MainActivity**
    * **ç°çŠ¶**: ç›®å‰åœ°å›¾ä¸Šçš„æ•°æ®æ¥æºæ˜¯ **é«˜å¾· POI æœç´¢**ã€‚ä»£ç ä¸­é€šè¿‡ `doSearchQuery()` å‘èµ·æœç´¢ï¼Œå¹¶åœ¨ `onPoiSearched()` å›è°ƒä¸­éå† `PoiItem` åˆ—è¡¨ï¼Œä½¿ç”¨ `aMap.addMarker()` æ·»åŠ é»˜è®¤å›¾æ ‡ã€‚**ä»£ç ä¸­æ²¡æœ‰ `initMockData()` æ–¹æ³•ã€‚**
    * **Member B ä»»åŠ¡**:
        1.  è¯·ç§»é™¤æˆ–æ³¨é‡Šæ‰ `doSearchQuery()` åŠ `onPoiSearched()` ä¸­çš„ POI æœç´¢ä¸å±•ç¤ºé€»è¾‘ã€‚
        2.  æ”¹ä¸ºåœ¨ `onCreate` æˆ– `onResume` ä¸­ç›‘å¬ Firestore çš„ `Notes` é›†åˆã€‚
        3.  è·å–åˆ°æ•°æ®å¿«ç…§åï¼Œæå–ç»çº¬åº¦ã€æ ‡é¢˜ç­‰ä¿¡æ¯ï¼Œè°ƒç”¨ `aMap.addMarker` å°†ç¬”è®°æ˜¾ç¤ºåœ¨åœ°å›¾ä¸Šï¼ˆåç»­å¯å‡çº§ä¸ºè°ƒç”¨ `ClusterOverlay`ï¼‰ã€‚

* **AddNoteActivity**
    * **ç°çŠ¶**: ç•Œé¢å·²å®Œæˆã€‚
        * **å›¾ç‰‡**: é€šè¿‡ `ActivityResultLauncher` è·å–äº†ç³»ç»Ÿå›¾åº“çš„å›¾ç‰‡ `Uri`ã€‚
        * **ä½ç½®**: é€šè¿‡ `RegeocodeQuery` å®ç°äº†åå‘åœ°ç†ç¼–ç ï¼Œåœ¨ `onRegeocodeSearched` ä¸­è·å–äº†å½“å‰è¡—é“åç§°ã€‚
        * **å‘å¸ƒæŒ‰é’®**: ç›®å‰ä»…å­˜åœ¨ UI äº¤äº’ï¼Œå°šæœªåŒ…å«ä¸Šä¼ é€»è¾‘ã€‚
    * **Member B ä»»åŠ¡**: è¯·åœ¨å‘å¸ƒæŒ‰é’® (`btn_publish`) çš„ç‚¹å‡»äº‹ä»¶ä¸­å®ç°ä»¥ä¸‹â€œçœŸå®é€»è¾‘â€ï¼š
        1.  **ä¸Šä¼ å›¾ç‰‡**: ä½¿ç”¨ Firebase Storage SDK ä¸Šä¼ å½“å‰é€‰ä¸­çš„å›¾ç‰‡ `Uri`ã€‚
        2.  **è·å–é“¾æ¥**: ä¸Šä¼ æˆåŠŸåï¼Œè·å–å›¾ç‰‡çš„ä¸‹è½½ URL (`downloadUrl`)ã€‚
        3.  **å†™å…¥æ•°æ®åº“**: å°†â€œæ ‡é¢˜ã€æè¿°ã€ç±»å‹ã€ç»çº¬åº¦ (`LatLonPoint`)ã€åœ°å€æ–‡æœ¬ã€å›¾ç‰‡ URLâ€å°è£…ä¸º Map æˆ–å¯¹è±¡ï¼Œå†™å…¥ Firestore çš„ `Notes` é›†åˆã€‚
        4.  **è¿”å›**: æ•°æ®åº“å†™å…¥æˆåŠŸåï¼Œè°ƒç”¨ `finish()` å…³é—­é¡µé¢ã€‚

3.  **å›¾ç‰‡åŠ è½½é€‚é…**
    * å‰ç«¯ç›®å‰ä½¿ç”¨èµ„æº ID (`R.drawable.xxx`) æˆ–æœ¬åœ° URI åšæ¼”ç¤ºã€‚
    * æ¥å…¥åï¼Œè¯·ç¡®ä¿ `RegionItem` ä¸­çš„ `photoUrl` å­—æ®µæ˜¯ Firebase Storage çš„ç½‘ç»œåœ°å€ï¼Œ`Glide` ä¼šè‡ªåŠ¨å¤„ç†åŠ è½½ã€‚

---

## 4. äº¤äº’ä¸ä¼˜åŒ–å¯¹æ¥æŒ‡å— (For Member C)

Member Cï¼Œä½ çš„ä»»åŠ¡æ˜¯åœ¨ Member B å®Œæˆæ•°æ®å±‚åï¼Œå®Œå–„ç”¨æˆ·ç³»ç»Ÿå’Œç»†èŠ‚ä½“éªŒã€‚

### ğŸ“‹ å¾…åŠäº‹é¡¹æ¸…å•
1.  **è®¤è¯é€»è¾‘å®ç°**
    * æˆ‘åœ¨ `LoginActivity` å’Œ `RegisterActivity` ä¸­ç•™ä¸‹äº† `TODO` æ³¨é‡Šã€‚
    * è¯·æ¥å…¥ **Firebase Auth** (Email/Password)ï¼Œå¹¶åœ¨ç™»å½•æˆåŠŸåä¿å­˜ç”¨æˆ·ä¿¡æ¯ã€‚
    * **å…¥å£**: ç›®å‰ `ProfileActivity` ç‚¹å‡»å¤´åƒå¯è·³è½¬ç™»å½•é¡µï¼Œè¯·å®Œå–„â€œå·²ç™»å½•/æœªç™»å½•â€çš„ UI çŠ¶æ€åˆ‡æ¢ã€‚

2.  **äº’åŠ¨åŠŸèƒ½**
    * **ç‚¹èµ**: `NoteCardAdapter` ä¸­æœ‰çˆ±å¿ƒå›¾æ ‡ (`iv_like_icon`)ï¼Œè¯·æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬ï¼Œæ›´æ–° Firestore è®¡æ•°ã€‚

3.  **UI/UX å¢å¼º (å¯é€‰/åŠ åˆ†é¡¹)**
    * **å¤šå›¾è½®æ’­**: ç›®å‰è¯¦æƒ…é¡µæ˜¯å•å›¾ã€‚å¦‚æœæ—¶é—´å…è®¸ï¼Œè¯·å°† `NoteDetailActivity` çš„ `ImageView` æ›¿æ¢ä¸º `ViewPager2`ã€‚
    * **ç­›é€‰åŠŸèƒ½**: æˆ‘åœ¨ `MainActivity` ä¸­é¢„ç•™äº†ç­›é€‰é€»è¾‘ã€‚è¯·é…åˆ Member B çš„æŸ¥è¯¢æ¥å£ï¼Œå®ç°åŸºäºâ€œæ ‡ç­¾â€çš„åœ°å›¾ç‚¹è¿‡æ»¤ã€‚

---

## 5. æ–‡ä»¶ç»“æ„å¯¼èˆª

```text
com.noworld.notemap
â”œâ”€â”€ overlay/                # åœ°å›¾è¦†ç›–ç‰©ç›¸å…³ (Route, Overlay)
â”‚   â”œâ”€â”€ ClusterOverlay.java # èšåˆæ ¸å¿ƒé€»è¾‘
â”‚   â””â”€â”€ ...
â”œâ”€â”€ service/                # åº”ç”¨çº§æœåŠ¡
â”‚   â””â”€â”€ App.java            # SDK åˆå§‹åŒ–ä¸éšç§æ£€æŸ¥
â”œâ”€â”€ ui/                     # ç•Œé¢å±‚
â”‚   â”œâ”€â”€ AddNoteActivity.java      # å‘å¸ƒç¬”è®°
â”‚   â”œâ”€â”€ ClusterDetailActivity.java # èšåˆåˆ—è¡¨é¡µ
â”‚   â”œâ”€â”€ LoginActivity.java        # ç™»å½• (UI Only)
â”‚   â”œâ”€â”€ MainActivity.java         # åœ°å›¾ä¸»é¡µ (Core)
â”‚   â”œâ”€â”€ NoteCardAdapter.java      # åˆ—è¡¨é€‚é…å™¨
â”‚   â”œâ”€â”€ NoteDetailActivity.java   # ç¬”è®°è¯¦æƒ…
â”‚   â”œâ”€â”€ PictureActivity.java      # (è¾…åŠ©) å›¾ç‰‡æŸ¥çœ‹
â”‚   â”œâ”€â”€ ProfileActivity.java      # ä¸ªäººä¸­å¿ƒ
â”‚   â””â”€â”€ RegisterActivity.java     # æ³¨å†Œ (UI Only)
â””â”€â”€ utils/                  # å·¥å…·ç±»
    â”œâ”€â”€ MapUtil.java
    â””â”€â”€ ChString.java